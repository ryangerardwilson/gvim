import geopandas as gpd
import matplotlib.pyplot as plt
import contextily as ctx
from shapely.geometry import Point

# Example coordinates (lon, lat)
coords = [
    (-73.9857, 40.7484),  # NYC
    (-0.1276, 51.5072),   # London
    (2.3522, 48.8566),    # Paris
]

gdf = gpd.GeoDataFrame(
    geometry=[Point(lon, lat) for lon, lat in coords],
    crs="EPSG:4326",
).to_crs(epsg=3857)

# Taller figure to reduce letterboxing with equal aspect
fig, ax = plt.subplots(figsize=(8, 7))
gdf.plot(ax=ax, color="#d0d0d0", markersize=60, alpha=0.9)

# Add a dark basemap (requires network access)
ctx.add_basemap(ax, source=ctx.providers.CartoDB.DarkMatter)

# Fit the view to the data bounds with padding
minx, miny, maxx, maxy = gdf.total_bounds
pad_x = (maxx - minx) * 0.1
pad_y = (maxy - miny) * 0.1
ax.set_xlim(minx - pad_x, maxx + pad_x)
ax.set_ylim(miny - pad_y, maxy + pad_y)

ax.set_axis_off()
ax.set_aspect("equal")

fig.savefig(__gtkv__.renderer, format="svg", dpi=200, transparent=True)
